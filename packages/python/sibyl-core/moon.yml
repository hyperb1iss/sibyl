$schema: https://moonrepo.dev/schemas/project.json
toolchains:
  default: system
language: python
tasks:
  sync:
    command: uv sync
    inputs:
    - '@group(configs)'
  lint:
    command: uv run ruff check src/ tests/
    inputs:
    - '@group(sources)'
    - '@group(tests)'
  format:
    command: uv run ruff format src/ tests/
    inputs:
    - '@group(sources)'
    - '@group(tests)'
  fix:
    script: uv run ruff check --fix src/ tests/ && uv run ruff format src/ tests/
    inputs:
    - '@group(sources)'
    - '@group(tests)'
    preset: server
  fix-all:
    script: uv run ruff check --fix --unsafe-fixes src/ tests/ && uv run ruff format src/ tests/
    inputs:
    - '@group(sources)'
    - '@group(tests)'
    preset: server
  typecheck:
    command: uv run ty check src/
    inputs:
    - '@group(sources)'
  test:
    command: uv run pytest tests/ -v
    inputs:
    - '@group(sources)'
    - '@group(tests)'
  test-cov:
    command: uv run pytest tests/ --cov=src --cov-report=term-missing --cov-report=xml:coverage.xml
    inputs:
    - '@group(sources)'
    - '@group(tests)'
    outputs:
    - coverage.xml
  check:
    deps:
    - ~:lint
    - ~:typecheck
    - ~:test
tags:
- python
- library
- core
fileGroups:
  sources:
  - src/**/*.py
  tests:
  - tests/**/*.py
  configs:
  - pyproject.toml
  - moon.yml
layer: library
