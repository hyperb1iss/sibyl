$schema: https://moonrepo.dev/schemas/project.json
language: python
toolchains:
  default: system
tasks:
  lint:
    command: uv run ruff check .
    inputs:
    - '@group(sources)'
  format:
    command: uv run ruff format .
    inputs:
    - '@group(sources)'
    preset: server
  fix:
    script: uv run ruff check --fix . && uv run ruff format .
    inputs:
    - '@group(sources)'
    preset: server
  typecheck:
    command: uvx ty check .
    inputs:
    - '@group(sources)'
  check:
    command: noop
    deps:
    - ~:lint
    - ~:typecheck
  install:
    options:
      shell: true
    script: echo 'Installing Claude Code hooks...' && mkdir -p ~/.claude/hooks/sibyl && cp ./*.py ~/.claude/hooks/sibyl/ && chmod +x ~/.claude/hooks/sibyl/*.py && python3 configure.py && echo '✓ Hooks installed - restart Claude Code to activate'
    preset: server
  uninstall:
    options:
      shell: true
    script: rm -rf ~/.claude/hooks/sibyl && echo '✓ Removed Sibyl hooks (settings.json unchanged - edit manually if needed)'
    preset: server
fileGroups:
  sources:
  - '*.py'
layer: tool
